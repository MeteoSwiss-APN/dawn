GTClang <br/> <a target="_blank" href="http://semver.org">![Version][Version.Badge]</a><!-- <a target="_blank" href="https://travis-ci.org/MeteoSwiss-APN/GTClang">![Travis status][TravisCI.Badge]</a>--> <a target="_blank" href="https://opensource.org/licenses/MIT">![License: MIT][MIT.License]</a>
===========

## Introduction

**GTClang** is part of a compiler toolchain for developing high-level DSLs for geophysical fluid dynamics models. **GTClang** is the front end part of the toolchain that processes a high level DSL and turns it into an intermediary representation (SIR), to be processed by dawn. See the top level `README` for a detailed description. Consider the following code snippet for an example stencil that performs two Laplacian operators in succesion using finite differences:

[![GTClang](https://raw.githubusercontent.com/MeteoSwiss-APN/dawn/master/gtclang/docs/images/hd.png)](https://github.com/MeteoSwiss-APN/dawn/releases)

## Building

Please ensure that dawn already built succesfully before attempting to build GTClang. Then:

```bash
cd dawn/GTClang/bundle
mkdir build && cd build
cmake .. -Ddawn_DIR=<path/to/dawn>/dawn/bundle/install/cmake #ADDITIONAL_FLAGS#
make -j6
make install
```

Where the `ADDITIONAL_FAGS` may include
* `-DProtobuf_DIR=</path/to/protobuf/>` if you already have a protobuf installation. If not, the build system will download and install protobuf for you. 
* `-DCLANG-FORMAT_EXECUTABLE=/usr/bin/clang-format` to add an additional target `make format` that formats the code into the formatting rules imposed by the project, as well as automatic code formatting for code generated by dawn.
* `-DGTCLANG_ENABLE_GRIDTOOLS=ON -DGTCLANG_BUILD_GT_CPU_EXAMPLES=ON` to enable dawn to generate code using the [gridtools](https://github.com/GridTools/gridtools) backend and perform code gen tests.
* `-DCMAKE_BUILD_TYPE=[Debug|Release|RelWithDebugInfo]` to set the build type 

## Testing

All **GTClang** tests are run using `Ctest`. They can be run using a single invocation of `Ctest` by:

```
cd GTClang/bundle/build/dawn-prefix/src/dawn-build/
ctest -V
```

Please allow up to a minute or so for all tests to complete.

## License

> The full license can be found [here](https://opensource.org/licenses/MIT).

This project is licensed under the terms of the **MIT** license.

<!-- Links -->
[Documentation.Badge]: https://img.shields.io/badge/documentation-link-blue.svg
[MIT.License]: https://img.shields.io/badge/License-MIT-blue.svg
[Version.Badge]: https://badge.fury.io/gh/MeteoSwiss-APN%2FGTClang.svg
